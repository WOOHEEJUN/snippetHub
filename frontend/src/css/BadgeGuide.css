/* =====================
   Layout
   ===================== */
.badge-guide-page{padding:40px 0;background:#1a1a1a;min-height:100vh;}
.page-header{text-align:center;margin-bottom:40px;color:#e0e0e0;}
.page-header h1{font-size:2.5rem;margin-bottom:10px;font-weight:700;}
.page-header p{font-size:1.1rem;opacity:.9;}

/* =====================
   Stats
   ===================== */
.stats-section{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:40px;}
.stats-card{background:#222;border-radius:12px;padding:25px;text-align:center;box-shadow:0 4px 20px rgba(0,0,0,.3);transition:.25s;}
.stats-card:hover{transform:translateY(-4px);}
.stats-number{font-size:2.5rem;font-weight:700;color:#8ab0d1;margin-bottom:8px;}
.stats-label{color:#b0b0b0;font-weight:500;}

/* =====================
   Category filter
   ===================== */
.filter-section{background:#222;border-radius:12px;padding:25px;margin-bottom:30px;box-shadow:0 4px 20px rgba(0,0,0,.3);}
.filter-section h3{color:#e0e0e0;margin-bottom:20px;font-weight:600;}
.category-filters{display:flex;flex-wrap:wrap;gap:12px;}
.category-filter{background:#333;border:2px solid #444;color:#e0e0e0;padding:10px 20px;border-radius:25px;cursor:pointer;font-weight:500;transition:.2s;}
.category-filter:hover{background:#444;border-color:#666;}
.category-filter.active{background:#8ab0d1;border-color:#8ab0d1;color:#333;}

/* =====================
   Grid / Card
   ===================== */
.badges-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:25px;}
.badge-card{
  background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02)) #181818;
  border-radius:12px;padding:25px;
  border:1px solid rgba(255,255,255,.06);
  box-shadow:0 10px 24px rgba(0,0,0,.35);
  backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);
  transition:.25s;position:relative;overflow:hidden;
}
.badge-card:hover{transform:translateY(-4px) scale(1.01);box-shadow:0 14px 28px rgba(0,0,0,.45);}
.badge-card.owned{outline:0;}
.badge-card.not-owned{filter:saturate(.65) contrast(.98) brightness(.96);}

/* =====================
   Badge coin (icon circle)
   ===================== */
.badge-image{position:relative;text-align:center;margin-bottom:20px;}

.badge-icon-container{
  --coin-size:78px;
  width:var(--coin-size);height:var(--coin-size);
  margin:0 auto;border-radius:50%;position:relative;isolation:isolate;

  /* 내부 표면(절제된 입체감) */
  background:
    radial-gradient(120px 120px at 35% 30%, rgba(255,255,255,.06), transparent 60%) padding-box,
    linear-gradient(180deg, rgba(255,255,255,.05), rgba(0,0,0,.08)) padding-box;

  /* 링은 border-image로 그립니다 (항상 보임) */
  border:3px solid transparent;
  border-image-slice:1;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.08),
    inset 0 -1px 0 rgba(0,0,0,.28),
    0 6px 18px rgba(0,0,0,.35);
  transition:.2s;
}
.badge-icon-container:hover{transform:translateY(-1px) scale(1.02);box-shadow:0 8px 18px rgba(0,0,0,.35);}

/* 중앙 레이어 (PNG/Iconify 공용) */
.icon-layer{position:relative;width:100%;height:100%;}
.iconify-img{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  display:block;width:64px;height:64px;z-index:2;opacity:.98;
}
.badge-emoji{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  font-size:28px;line-height:1;color:#fff;z-index:1;transition:opacity .2s;
}
/* 중앙 PNG용(예: /public/badges/badge_*.png) */
.rarity-coin{
  position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);
  display:block;width:64px;height:64px;z-index:2;image-rendering:auto;
}

/* =====================
   Rarity ring (border-image)
   ===================== */
/* 공통: 각 카드가 data-rarity를 가집니다. 해당 값에 맞춰 링을 채웁니다. */
[data-rarity="common"] .badge-icon-container{
  border-image: conic-gradient(#3a3a3a, #343434, #3a3a3a) 1;
}

[data-rarity="uncommon"] .badge-icon-container{
  border-image: conic-gradient(
    color-mix(in oklab, var(--accent,#8ab0d1) 30%, #202020),
    color-mix(in oklab, var(--accent,#8ab0d1) 15%, #202020) 55%,
    color-mix(in oklab, var(--accent,#8ab0d1) 30%, #202020)
  ) 1;
}

[data-rarity="rare"] .badge-icon-container{
  border-image: conic-gradient(
    color-mix(in oklab, var(--accent,#8ab0d1) 45%, #1a1a1a),
    color-mix(in oklab, var(--accent,#8ab0d1) 22%, #1a1a1a) 50%,
    color-mix(in oklab, var(--accent,#8ab0d1) 45%, #1a1a1a)
  ) 1;
}

[data-rarity="epic"] .badge-icon-container{
  border-image: conic-gradient(
    /* 파스텔 멀티톤 */
    color-mix(in oklab, #9b87f5 38%, #141414),
    color-mix(in oklab, #67e8f9 32%, #141414) 33%,
    color-mix(in oklab, #86efac 32%, #141414) 66%,
    color-mix(in oklab, #9b87f5 38%, #141414)
  ) 1;
}

[data-rarity="legendary"] .badge-icon-container{
  border-image: conic-gradient(
    color-mix(in oklab, #ff7a00 36%, #111),
    color-mix(in oklab, #ffd400 36%, #111) 20%,
    color-mix(in oklab, #64ffda 32%, #111) 40%,
    color-mix(in oklab, #8a2be2 36%, #111) 60%,
    color-mix(in oklab, #00e5ff 32%, #111) 80%,
    color-mix(in oklab, #ff7a00 36%, #111)
  ) 1;
}

/* color-mix 미지원 브라우저를 위한 안전 팔레트 */
@supports not (color-mix(in oklab, black 50%, white 50%)){
  [data-rarity="uncommon"] .badge-icon-container{
    border-image: conic-gradient(#79a9c9, #3b5668, #79a9c9) 1;
  }
  [data-rarity="rare"] .badge-icon-container{
    border-image: conic-gradient(#8ab0d1, #486275, #8ab0d1) 1;
  }
  [data-rarity="epic"] .badge-icon-container{
    border-image: conic-gradient(#9b87f5, #67e8f9, #86efac, #9b87f5) 1;
  }
  [data-rarity="legendary"] .badge-icon-container{
    border-image: conic-gradient(#ff7a00, #ffd400, #64ffda, #8a2be2, #00e5ff, #ff7a00) 1;
  }
}

/* =====================
   Owned check
   ===================== */
.owned-badge{
  position:absolute;top:-6px;right:50%;transform:translateX(50%);
  background:linear-gradient(180deg,#9be58c,#3cb371);
  color:#091207;width:22px;height:22px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-weight:700;font-size:12px;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 2px 8px rgba(0,0,0,.25);
}

/* =====================
   Info / Text
   ===================== */
.badge-info{text-align:center;}
.badge-name{color:#e0e0e0;margin-bottom:10px;font-weight:600;font-size:1.2rem;}
.badge-description{color:#b0b0b0;margin-bottom:15px;line-height:1.5;}
.badge-category{margin-bottom:15px;}
.category-tag{display:inline-block;padding:5px 12px;border-radius:15px;font-size:.8rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px;}
.category-tag.use-accent{color:var(--accent,#8ab0d1);border:1px solid var(--accent,#8ab0d1);background:#333;}

/* =====================
   Progress
   ===================== */
.progress-section{margin-bottom:15px;}
.progress-bar{width:100%;height:10px;background:#2d2d2d;border-radius:999px;overflow:hidden;margin-bottom:8px;}
.progress-fill{
  height:100%;border-radius:999px;
  background:linear-gradient(90deg,color-mix(in oklab,var(--accent,#8ab0d1) 55%,#fff) 0%,color-mix(in oklab,var(--accent,#8ab0d1) 25%,#fff) 100%);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.18);
}
.progress-text{font-size:.9rem;color:#b0b0b0;font-weight:500;}

/* =====================
   Empty / states
   ===================== */
.no-badges,.loading-message,.error-message{text-align:center;background:#222;border-radius:12px;padding:40px;color:#b0b0b0;margin:20px 0;}
.error-message{color:#dc3545;background:#3a2a3a;border:1px solid #5a3a3a;}

/* =====================
   Responsive
   ===================== */
@media (max-width:768px){
  .badge-guide-page{padding:20px 0;}
  .page-header h1{font-size:2rem;}
  .stats-section{grid-template-columns:1fr;}
  .badges-grid{grid-template-columns:1fr;}
  .category-filters{justify-content:center;}
  .badge-card{padding:20px;}
}

/* =========================================================
   ✨ Rarity Aura & Animation (add-on)
   - 희귀도별 오라/회전/스파클 강화
   - 기존 border-image 링은 유지 + 여기에 오라 레이어만 추가
   ========================================================= */

/* 공통 키프레임 */
@keyframes spin360 { to { transform: rotate(360deg); } }
@keyframes glowPulse { 0%,100% { opacity:.35; transform:scale(1);} 50% { opacity:.9; transform:scale(1.06);} }
@keyframes twinkle   { 0%,100% { opacity:.15; } 50% { opacity:.85; } }
@keyframes sweepShine{
  0%   { transform: translate(-120%, -120%) rotate(35deg); }
  100% { transform: translate(120%, 120%) rotate(35deg); }
}

/* 오라 레이어 준비 */
.badge-icon-container{ position:relative; isolation:isolate; z-index:0; }
.badge-icon-container::before,
.badge-icon-container::after{
  content:""; position:absolute; inset:-7px; border-radius:50%;
  pointer-events:none; z-index:-1;
}

/* ::before = 회전 링(얇은 고리)  — 실제 border-image 위에 얇게 겹침 */
.badge-icon-container::before{
  /* 안쪽은 비우고 바깥쪽 고리만 보이도록 마스크 */
  -webkit-mask:
    radial-gradient(circle at center, transparent 58%, #000 60%),
    linear-gradient(#000, #000);
  -webkit-mask-composite: source-out;
          mask-composite: exclude;
  opacity:.0; /* 각 희귀도에서 조절 */
}

/* ::after = 외곽 오라 + 스파클 + 스윕 하이라이트 */
.badge-icon-container::after{
  inset:-18px;
  background:
    radial-gradient(60% 60% at 50% 50%, rgba(255,255,255,.18), transparent 70%),
    radial-gradient(3px 3px at 20% 30%, rgba(255,255,255,.85), transparent 40%),
    radial-gradient(2.5px 2.5px at 70% 60%, rgba(255,255,255,.75), transparent 42%),
    radial-gradient(2.5px 2.5px at 35% 75%, rgba(255,255,255,.7), transparent 42%),
    radial-gradient(2px 2px at 80% 25%, rgba(255,255,255,.75), transparent 45%);
  mix-blend-mode: screen;
  filter: blur(1px);
  opacity:.0; /* 각 희귀도에서 조절 */
}

/* 중앙 PNG에 은은한 틸트/광택 */
.rarity-coin{ animation: glowPulse 8s ease-in-out infinite; }

/* ===== 희귀도별 세팅 ===== */

/* D/F : 거의 정적인 가벼운 오라 */
[data-rarity="common"] .badge-icon-container::after{
  opacity:.18; filter: blur(2px);
  animation: glowPulse 4.5s ease-in-out infinite;
}

/* C : 아주 느린 회전 + 살짝 더 밝은 오라 */
[data-rarity="uncommon"] .badge-icon-container::before{
  background: conic-gradient(from 0deg,
    color-mix(in oklab, var(--accent,#8ab0d1) 32%, #111),
    transparent 35%,
    color-mix(in oklab, var(--accent,#8ab0d1) 32%, #111));
  opacity:.35; animation: spin360 16s linear infinite;
}
[data-rarity="uncommon"] .badge-icon-container::after{
  opacity:.25; filter: blur(3px);
  animation: glowPulse 4s ease-in-out infinite;
}

/* B : 느린 멀티톤 회전 + 스윕 하이라이트 */
[data-rarity="rare"] .badge-icon-container::before{
  background: conic-gradient(from 0deg,
    color-mix(in oklab, var(--accent,#8ab0d1) 55%, #0f0f0f),
    color-mix(in oklab, #b5d4ea 40%, #0f0f0f) 50%,
    color-mix(in oklab, var(--accent,#8ab0d1) 55%, #0f0f0f));
  opacity:.55; animation: spin360 12s linear infinite;
}
[data-rarity="rare"] .badge-icon-container::after{
  opacity:.35; filter: blur(4px);
  animation: glowPulse 3.6s ease-in-out infinite;
}
[data-rarity="rare"] .badge-icon-container::after{
  /* 스윕 하이라이트 */
  mask: linear-gradient(90deg, transparent 35%, #000 50%, transparent 65%);
  animation: sweepShine 3.8s linear infinite, glowPulse 3.6s ease-in-out infinite;
  opacity:.25;
}

/* A : 화려한 파스텔 무지개 회전 + 더 강한 오라/트윙클 */
[data-rarity="epic"] .badge-icon-container::before{
  background: conic-gradient(from 0deg,#9b87f5,#67e8f9,#86efac,#ffd54f,#ff7aa2,#9b87f5);
  opacity:.8; animation: spin360 7s linear infinite;
  filter: drop-shadow(0 0 8px rgba(255,255,255,.3));
}
[data-rarity="epic"] .badge-icon-container::after{
  opacity:.55; filter: blur(5px);
  animation: glowPulse 2.6s ease-in-out infinite, twinkle 1.8s ease-in-out infinite;
}

/* S : 강한 무지개 링 + 이중 회전 + 오라/트윙클 최대로 */
[data-rarity="legendary"] .badge-icon-container::before{
  inset:-9px;
  background: conic-gradient(from 0deg,#ff0040,#ff7a00,#ffd400,#3be000,#00e5ff,#0066ff,#b400ff,#ff0040);
  opacity:.95; animation: spin360 4.2s linear infinite;
  filter: drop-shadow(0 0 10px rgba(255,255,255,.4));
}
[data-rarity="legendary"] .badge-icon-container::after{
  inset:-22px;
  background:
    radial-gradient(65% 65% at 50% 50%, rgba(255,255,255,.26), transparent 70%),
    radial-gradient(3px 3px at 22% 28%, rgba(255,255,255,.95), transparent 45%),
    radial-gradient(2.5px 2.5px at 78% 58%, rgba(255,255,255,.85), transparent 42%),
    radial-gradient(2.5px 2.5px at 38% 76%, rgba(255,255,255,.8), transparent 42%),
    radial-gradient(2px 2px at 84% 22%, rgba(255,255,255,.85), transparent 45%);
  mix-blend-mode: screen;
  opacity:.85; filter: blur(6px);
  animation: glowPulse 2.2s ease-in-out infinite, twinkle 1.6s ease-in-out infinite, spin360 9s linear infinite;
}

/* 모션 민감 사용자 보호 */
@media (prefers-reduced-motion: reduce){
  .badge-icon-container::before,
  .badge-icon-container::after,
  .rarity-coin{ animation: none !important; }
}
